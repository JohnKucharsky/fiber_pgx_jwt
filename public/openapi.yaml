openapi: 3.0.3
info:
  title: DVD Rental API
  description: DVD Rental dataset API
  version: 1.0.0
servers:
  - url: http://localhost:8080/api
tags:
  - name: Actor
  - name: Country
  - name: City
  - name: Address
  - name: Category
  - name: Language
  - name: Customer
  - name: Staff
paths:
  /auth/sign-up:
    post:
      tags:
        - Authorization
      summary: Register
      operationId: SignUp
      requestBody:
        $ref: '#/components/requestBodies/SignUpInput'
      responses:
        '201':
          $ref: '#/components/responses/User'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
  /auth/login:
    post:
      tags:
        - Authorization
      summary: Login
      description: Sign in to the app. Returns cookies, access_token, refresh_token, logged_in
      operationId: SignIn
      requestBody:
        $ref: '#/components/requestBodies/SignInInput'
      responses:
        '201':
          $ref: '#/components/responses/LoginRes'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
  /auth/logout:
    get:
      tags:
        - Authorization
      security:
        - access_token: [ ]
        - Authorization: [ ]
      summary: Logout
      description: Destroys all cookies, finishes local session, saved on the server
      operationId: Logout
      responses:
        '201':
          $ref: '#/components/responses/EmptyOkResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /auth/refresh:
    get:
      tags:
        - Authorization
      security:
        - refresh_token: [ ]
      summary: Refresh token
      description: Sets new access_token and logged_in(HTTPOnly:false). refresh_token stays the same until expires
      operationId: RefreshToken
      responses:
        '201':
          $ref: '#/components/responses/AccessToken'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /auth/me:
    get:
      tags:
        - Authorization
      security:
        - access_token: [ ]
        - Authorization: [ ]
      summary: Get me
      description: Get info about currently authorized user
      operationId: GetMe
      responses:
        '201':
          $ref: '#/components/responses/User'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /actor:
    post:
      tags:
        - Actor
      summary: Create an actor
      security:
        - access_token: [ ]
        - Authorization: [ ]
      operationId: ActorPost
      requestBody:
        $ref: '#/components/requestBodies/ActorInput'
      responses:
        '201':
          $ref: '#/components/responses/OneActor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Actor
      summary: Get all actors
      operationId: GetManyActors
      responses:
        '200':
          $ref: '#/components/responses/ManyActors'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /actor/{id}:
    get:
      tags:
        - Actor
      description: Get actor by id
      operationId: GetOneActor
      responses:
        '200':
          $ref: '#/components/responses/OneActor'
    put:
      tags:
        - Actor
      description: Update actor
      operationId: UpdateActor
      requestBody:
        $ref: '#/components/requestBodies/ActorInput'
      responses:
        '201':
          $ref: '#/components/responses/OneActor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - Actor
      description: Delete an actor
      operationId: DeleteActor
      responses:
        '201':
          $ref: '#/components/responses/OneActor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /country:
    post:
      tags:
        - Country
      summary: Create a country
      operationId: CountryPost
      requestBody:
        $ref: '#/components/requestBodies/CountryInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCountry'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Country
      summary: Get all countries
      operationId: GetManyCountries
      responses:
        '200':
          $ref: '#/components/responses/ManyCountries'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /country/{id}:
    get:
      tags:
        - Country
      description: Get country by id
      operationId: GetOneCountry
      responses:
        '200':
          $ref: '#/components/responses/OneCountry'
    put:
      tags:
        - Country
      description: Update country
      operationId: UpdateCountry
      requestBody:
        $ref: '#/components/requestBodies/CountryInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCountry'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - Country
      description: Delete a country
      operationId: DeleteCountry
      responses:
        '201':
          $ref: '#/components/responses/OneCountry'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /city:
    post:
      tags:
        - City
      summary: Create a city
      operationId: CityPost
      requestBody:
        $ref: '#/components/requestBodies/CityInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCity'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - City
      summary: Get all cities
      operationId: GetManyCities
      responses:
        '200':
          $ref: '#/components/responses/ManyCities'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /city/{id}:
    get:
      tags:
        - City
      description: Get city by id
      operationId: GetOneCity
      responses:
        '200':
          $ref: '#/components/responses/OneCity'
    put:
      tags:
        - City
      description: Update city
      operationId: UpdateCity
      requestBody:
        $ref: '#/components/requestBodies/CityInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCity'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - City
      description: Delete a city
      operationId: DeleteCity
      responses:
        '201':
          $ref: '#/components/responses/OneCity'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /address:
    post:
      tags:
        - Address
      summary: Create an address
      operationId: AddressPost
      requestBody:
        $ref: '#/components/requestBodies/AddressInput'
      responses:
        '201':
          $ref: '#/components/responses/OneAddress'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Address
      summary: Get all address
      operationId: GetManyAddress
      responses:
        '200':
          $ref: '#/components/responses/ManyAddresses'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /address/{id}:
    get:
      tags:
        - Address
      description: Get address by id
      operationId: GetOneAddress
      responses:
        '200':
          $ref: '#/components/responses/OneAddress'
    put:
      tags:
        - Address
      description: Update address
      operationId: UpdateAddress
      requestBody:
        $ref: '#/components/requestBodies/AddressInput'
      responses:
        '201':
          $ref: '#/components/responses/OneAddress'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - Address
      description: Delete an address
      operationId: DeleteAddress
      responses:
        '201':
          $ref: '#/components/responses/OneAddress'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /category:
    post:
      tags:
        - Category
      summary: Create a category
      security:
        - access_token: [ ]
        - Authorization: [ ]
      operationId: CategoryPost
      requestBody:
        $ref: '#/components/requestBodies/CategoryInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCategory'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Category
      summary: Get all categories
      operationId: GetManyCategories
      responses:
        '200':
          $ref: '#/components/responses/ManyCategories'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /category/{id}:
    get:
      tags:
        - Category
      description: Get category by id
      operationId: GetOneCategory
      responses:
        '200':
          $ref: '#/components/responses/OneCategory'
    put:
      tags:
        - Category
      security:
        - access_token: [ ]
        - Authorization: [ ]
      description: Update category
      operationId: UpdateCategory
      requestBody:
        $ref: '#/components/requestBodies/CategoryInput'
      responses:
        '201':
          $ref: '#/components/responses/OneCategory'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    delete:
      tags:
        - Category
      description: Delete an category
      operationId: DeleteCategory
      responses:
        '201':
          $ref: '#/components/responses/OneCategory'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /staff:
    post:
      tags:
        - Staff
      summary: Create staff
      security:
        - access_token: [ ]
        - Authorization: [ ]
      operationId: StaffPost
      requestBody:
        $ref: '#/components/requestBodies/StaffInput'
      responses:
        '201':
          $ref: '#/components/responses/OneStaff'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Staff
      summary: Get all staff
      operationId: GetManyStaff
      responses:
        '200':
          $ref: '#/components/responses/ManyStaff'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /staff/{id}:
    get:
      tags:
        - Staff
      description: Get staff by id
      operationId: GetOneStaff
      responses:
        '200':
          $ref: '#/components/responses/OneStaff'
    put:
      tags:
        - Staff
      description: Update staff
      operationId: UpdateStaff
      requestBody:
        $ref: '#/components/requestBodies/StaffInput'
      responses:
        '201':
          $ref: '#/components/responses/OneStaff'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - Staff
      description: Delete staff
      operationId: DeleteStaff
      responses:
        '201':
          $ref: '#/components/responses/OneStaff'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
  /language:
    post:
      tags:
        - Language
      summary: Create language
      security:
        - access_token: [ ]
        - Authorization: [ ]
      operationId: LanguagePost
      requestBody:
        $ref: '#/components/requestBodies/LanguageInput'
      responses:
        '201':
          $ref: '#/components/responses/OneLanguage'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
      x-codegen-request-body-name: body
    get:
      tags:
        - Language
      summary: Get all languages
      operationId: GetManyLanguages
      responses:
        '200':
          $ref: '#/components/responses/ManyLanguages'
        '401':
          $ref: '#/components/responses/Unauthorized'
  /language/{id}:
    get:
      tags:
        - Language
      description: Get language by id
      operationId: GetOneLanguage
      responses:
        '200':
          $ref: '#/components/responses/OneLanguage'
    put:
      tags:
        - Language
      description: Update language
      operationId: UpdateLanguage
      requestBody:
        $ref: '#/components/requestBodies/LanguageInput'
      responses:
        '201':
          $ref: '#/components/responses/OneLanguage'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
    delete:
      tags:
        - Language
      description: Delete language
      operationId: DeleteLanguage
      responses:
        '201':
          $ref: '#/components/responses/OneLanguage'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          $ref: '#/components/responses/GenericError'
components:
  securitySchemes:
    access_token:
      description: |
        You have to have access token in access token cookie to authorize request
      type: apiKey
      name: access_token
      in: cookie
    refresh_token:
      description: |
        Refresh token is used to gain new access token
      type: apiKey
      name: refresh_token
      in: cookie
    Authorization:
      type: apiKey
      name: Authorization
      in: header
      description: |
        Prefix the value with "Authorization" to indicate the custom authorization type
  responses:
    OneStaff:
      description: Staff
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Staff'
    ManyStaff:
      description: Staff array
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Staff'
    OneCustomer:
      description: Customer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Customer'
    ManyCustomers:
      description: Customers array
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Customer'
    OneLanguage:
      description: Language
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Language'
    ManyLanguages:
      description: Languages array
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Language'
    OneCategory:
      description: Category
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Category'
    ManyCategories:
      description: Categories array
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Category'
    ManyActors:
      description: Actors array
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Actor'
    OneActor:
      description: One Actor
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Actor'
    ManyCountries:
      description: Many countries
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Country'
    OneCountry:
      description: One country
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Country'
    ManyCities:
      description: Many cities
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/City'
    OneCity:
      description: One city
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/City'
    ManyAddresses:
      description: Many addresses
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Address'
    OneAddress:
      description: One address
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Address'
    User:
      description: User
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/User'
    LoginRes:
      description: User, access token, refresh_token, logged_in
      headers:
        Set-Cookie:
          schema:
            type: string
            example: access_token httponly, refresh_token httponly, logged_in boolean
      content:
        application/json:
          schema:
            type: object
            properties:
              access_token:
                type: string
              user:
                $ref: '#/components/schemas/User'
    AccessToken:
      description: Access token
      headers:
        Set-Cookie:
          schema:
            type: string
            example: access_token httponly, logged_in boolean
      content:
        application/json:
          schema:
            type: object
            properties:
              access_token:
                type: string
    Unauthorized:
      description: Unauthorized
      content: { }
    GenericError:
      description: Unexpected error
      content: { }
    EmptyOkResponse:
      description: No content
      content:
        text/html:
          schema:
            type: string
  requestBodies:
    StaffInput:
      required: true
      description: Update and create staff
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/StaffInput'
    CustomerInput:
      required: true
      description: Update and create customer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CustomerInput'
    LanguageInput:
      required: true
      description: Update and create language
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LanguageInput'
    CategoryInput:
      required: true
      description: Update and create category
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CategoryInput'
    ActorInput:
      required: true
      description: Create and update actor
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ActorInput'
    CountryInput:
      required: true
      description: Create and update country
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CountryInput'
    CityInput:
      required: true
      description: Create and update city
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CityInput'
    AddressInput:
      required: true
      description: Create and update address
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/AddressInput'
    SignUpInput:
      required: true
      description: Register a user
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SignUpInput'
    SignInInput:
      required: true
      description: Login
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SignInInput'
  schemas:
    Staff:
      required:
        - id
        - first_name
        - last_name
        - email
        - store_id
        - active
        - username
        - password
        - picture
        - address_id
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        first_name:
          type: string
          example: John
        last_name:
          type: string
          example: Doe
        email:
          type: string
          nullable: true
          example: example@mail.com
        store_id:
          type: integer
          nullable: true
          example: 1
        active:
          type: boolean
          example: false
        username:
          type: string
          example: bigDaddy
        password:
          type: string
          nullable: true
          example: 12345678
        picture:
          type: string
          format: binary
          nullable: true
          example: 'null'
        address:
          anyOf:
            - type: 'null'
            - $ref: '#/components/schemas/Address'
        updated_at:
          type: string
          format: date-time
          example: 01.02.2020
    StaffInput:
      required:
        - first_name
        - last_name
        - active
        - username
      type: object
      properties:
        first_name:
          type: string
          example: John
        last_name:
          type: string
          example: Doe
        email:
          type: string
          nullable: true
          example: johnydoe@mail.com
        store_id:
          type: number
          nullable: true
          example: 1
        active:
          type: boolean
          example: false
        username:
          type: string
          example: exceptional
        password:
          type: string
          nullable: true
          example: 12345678
        picture:
          type: string
          format: binary
          nullable: true
          example: null
        address_id:
          type: integer
          nullable: true
          example: 1
    Customer:
      required:
        - id
        - store_id
        - first_name
        - last_name
        - email
        - address
        - active
        - create_date
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        store_id:
          type: integer
          example: 1
        first_name:
          type: string
          example: Andrew
        last_name:
          type: string
          example: Gam
        email:
          type: string
          nullable: true
          example: test@mail.com
        address:
          anyOf:
            - type: 'null'
            - $ref: '#/components/schemas/Address'
          example: 'null'
        active:
          type: boolean
          example: false
        create_date:
          type: string
          format: date-time
          example: 02.02.2023
        updated_at:
          type: string
          format: date-time
          example: 03.04.2022
    CustomerInput:
      required:
        - store_id
        - first_name
        - last_name
        - active
        - create_date
      type: object
      properties:
        store_id:
          type: integer
          example: 1
        first_name:
          type: string
          example: Sarah
        last_name:
          type: string
          example: McLittle
        email:
          type: string
          example: m@mail.com
        address_id:
          type: integer
          example: 1
        active:
          type: boolean
          example: false
        create_date:
          type: string
          format: date-time
          example: 01.04.2021
    Language:
      required:
        - id
        - name
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: German
        updated_at:
          type: string
          format: date-time
          example: 02.02.2003
    LanguageInput:
      required:
        - name
      type: object
      properties:
        name:
          type: string
          example: English
    Category:
      required:
        - id
        - name
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: Horror
        updated_at:
          type: string
          format: date-time
          example: 04.05.2025
    CategoryInput:
      required:
        - name
      type: object
      properties:
        name:
          type: string
          example: Comedy
    Actor:
      required:
        - id
        - first_name
        - last_name
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        first_name:
          type: string
          example: John
        last_name:
          type: string
          example: Travolta
        updated_at:
          type: string
          format: date-time
          example: 01.02.2024
    ActorInput:
      required:
        - first_name
        - last_name
      type: object
      properties:
        first_name:
          type: string
          example: Jim
        last_name:
          type: string
          example: Carey
    Country:
      required:
        - id
        - country
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        country:
          type: string
          example: Russia
        updated_at:
          type: string
          format: date-time
          example: 12.03.2024
    CountryInput:
      required:
        - country
      type: object
      properties:
        country:
          type: string
          example: France
    City:
      required:
        - id
        - city
        - country
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        city:
          type: string
          example: Moscow
        country:
          anyOf:
            - type: 'null'
            - $ref: '#/components/schemas/Country'
          example: 'null'
        updated_at:
          type: string
          format: date-time
          example: 02.02.2024
    CityInput:
      required:
        - city
        - country_id
      type: object
      properties:
        city:
          type: string
          example: Krasnodar
        country_id:
          type: string
          example: 1
    Address:
      required:
        - id
        - address
        - address2
        - district
        - city
        - country
        - postal_code
        - phone
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        address:
          type: string
          example: 1 Vancouver Road, Norwich",NR7 9UJ
        address2:
          type: string
          nullable: true
          example: 1 Dashwood Drive, Telford",TF1 3QW
        district:
          type: string
          example: California
        city:
          anyOf:
            - type: 'null'
            - $ref: '#/components/schemas/City'
          example: 'null'
        country:
          anyOf:
            - type: 'null'
            - $ref: '#/components/schemas/Country'
          example: 'null'
        postal_code:
          type: integer
          nullable: true
          example: 630526
        phone:
          type: string
          example: +79993337788
        updated_at:
          type: string
          format: date-time
          example: 02.02.2020
    AddressInput:
      required:
        - address
        - district
        - phone
      type: object
      properties:
        address:
          type: string
          example: 1 Vancouver Road, Norwich",NR7 9UJ
        address2:
          type: string
          nullable: true
          example: 1 Dashwood Drive, Telford",TF1 3QW
        district:
          type: string
          example: New York
        city_id:
          type: integer
          nullable: true
          example: 1
        postal_code:
          type: integer
          nullable: true
          example: 333888
        phone:
          type: string
          example: +73447882211
    SignUpInput:
      required:
        - name
        - email
        - password
      properties:
        name:
          type: string
          example: Mat
        email:
          type: string
          example: mat@mail.com
        password:
          type: string
          minLength: '8'
          example: 123456789
    User:
      required:
        - id
        - name
        - email
        - updated_at
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: John
        email:
          type: string
          example: john@mail.com
        updated_at:
          type: string
          format: date-time
          example: 02.03.2020
    SignInInput:
      required:
        - email
        - password
      properties:
        email:
          type: string
          example: a@live.com
        password:
          type: string
          minLength: '8'
          example: superSecretPass